# Найти интервалы последовательности чисел

> Change language: [![Русский](../../docs/assets/images/ru.gif)](README.md) [![English](../../docs/assets/images/en.gif)](README.en.md)


## Задание

Таблицу test1 заполнили последовательными целыми положительными числами (от 1 до n), 
а затем некоторые из них удалили случайным образом. 
Необходимо написать SQL-запрос, который выводил бы интервалы, в которых недостает чисел.

Пример схемы и данных:

```
CREATE TABLE test1 (
  id INT NOT NULL PRIMARY KEY
);

INSERT INTO test1 (id) VALUES (1), (2), (3), (6), (8), (9), (12);
```

Таким должен быть результат:

```
FROM | TO
3    | 6
6    | 8
9    | 12
```

## Решение

  1. Находим все числа (id) после которых разрывается последовательность
  2. Создаём таблицу интервалов (из двух столбцов): id, next_id (from, to)
  3. Соединяем таблицу 1 и 2

[Посмотреть SQL запрос](solution.sql)

[Посмотреть в действии](https://www.db-fiddle.com/f/cR9JumAswjAyZpgYgerJiE/0)